# ADR-002: VideoPlanet 영상 기획 메뉴 리팩토링 아키텍처 결정

## 상태
**채택됨** - 2025-08-23

## 컨텍스트

### 현재 상황
VideoPlanet의 영상 기획 시스템이 복잡한 이중 모드 구조(AI 기획 + 수동 기획)로 구현되어 있어 다음과 같은 문제점이 발생했습니다:

1. **아키텍처 복잡성**
   - 모드 선택을 위한 불필요한 UI 복잡도
   - AI 기획과 수동 기획의 분산된 코드 구조
   - 중복된 타입 정의 (2곳에 동일한 인터페이스)

2. **사용자 경험 문제**  
   - 모드 선택으로 인한 인지적 부담 증가
   - 수동 기획의 낮은 사용률 (예상 5% 미만)
   - 복잡한 사용자 플로우

3. **유지보수성 문제**
   - FSD 아키텍처 원칙 위반
   - app layer에서의 직접적인 비즈니스 로직 처리
   - 분산된 기능으로 인한 응집성 부족

### 비즈니스 요구사항
- **핵심 기능 집중**: AI 기획 기능에 집중하여 사용자 경험 극대화
- **단순화**: 복잡한 모드 선택 제거로 직관적인 인터페이스 제공
- **개발 효율성**: 유지보수 비용 절감 및 신규 기능 개발 속도 향상

## 결정사항

### 1. 영상 기획 시스템 단순화
**AI 기획 중심의 단일 모드 시스템으로 리팩토링**

#### 제거 결정
- ✅ **모드 선택 기능 완전 제거**
  - `planningMode` 상태 관리 제거
  - 모드 선택 UI 컴포넌트 제거
  
- ✅ **수동 기획 기능 완전 제거**
  - `/features/plan-creation/` 디렉토리 전체 제거
  - `PlanCreationForm` 및 관련 컴포넌트 제거
  - 수동 기획 관련 API 로직 정리

#### 유지 결정
- ✅ **AI 기획 핵심 기능**
  - AI 기획서 자동 생성
  - 4단계 스토리 구조 생성
  - 12개 숏트 분해
  - 기획서 편집 및 관리

### 2. FSD 아키텍처 준수 강화

#### 타겟 아키텍처
```typescript
src/
├── entities/
│   └── video-planning/           # 통합 도메인 엔티티
│       ├── model/
│       │   ├── types.ts         # 통합된 타입 정의 (AI 기획 전용)
│       │   ├── planning.slice.ts # 단순화된 상태 관리  
│       │   └── selectors.ts     # 최적화된 선택자
│       ├── api/
│       │   ├── ai-planning.api.ts   # AI 기획 API
│       │   └── planning-crud.api.ts # CRUD API
│       └── index.ts             # 엄격한 Public API
├── features/
│   ├── ai-planning/              # AI 기획 생성 피처
│   │   ├── ui/                  # AI 기획 관련 UI 컴포넌트
│   │   ├── model/               # AI 기획 상태 관리
│   │   └── lib/                 # AI 기획 비즈니스 로직
│   └── planning-management/      # 기획서 관리 피처  
│       ├── ui/                  # 목록, 상세, 편집 UI
│       └── model/               # 관리 상태 로직
└── app/
    └── video-planning/
        └── page.tsx             # 단일 페이지 (AI 기획 전용)
```

### 3. API 계약 단순화

#### AS-IS (현재)
```typescript
interface CreatePlanRequest {
  planType: 'ai-generated' | 'manual' | 'hybrid'  // 복잡함
}
```

#### TO-BE (리팩토링 후)
```typescript
interface CreatePlanRequest {
  planType: 'ai-generated'  // AI 기획 전용으로 고정
}
```

### 4. 타입 시스템 통합

#### 문제 상황
```typescript
// 중복 정의 1: /entities/video-planning/model/types.ts
interface AIGenerationPlanRequest { ... }

// 중복 정의 2: /app/video-planning/ai/page.tsx  
interface AIGeneratePlanRequest { ... }
```

#### 해결 방안
```typescript
// 단일 소스: /entities/video-planning/model/types.ts
export interface VideoPlanningRequest {
  // AI 기획 전용 통합 타입
  title: string
  concept: string
  purpose: string
  // ... 기타 필드들
}
```

## 마이그레이션 전략

### Phase 1: 준비 작업 (1-2일)
1. **타입 통합**
   - 중복 타입 정의 제거
   - AI 기획 전용 타입으로 통합
   
2. **의존성 분석**  
   - 제거 대상 컴포넌트의 참조 관계 분석
   - 영향 범위 최종 확인

### Phase 2: 코어 리팩토링 (2-3일)
1. **UI 레이어 단순화**
   ```bash
   # 모드 선택 제거
   - app/video-planning/page.tsx: planningMode 상태 제거
   - 직접 AI 기획 인터페이스로 이동
   
   # AI 기획 페이지 통합
   - app/video-planning/ai/page.tsx → 메인 페이지로 통합
   ```

2. **Feature 레이어 정리**
   ```bash
   # 수동 기획 기능 제거
   rm -rf src/features/plan-creation/
   
   # AI 기획 Feature 신규 생성
   mkdir -p src/features/ai-planning/{ui,model,lib}
   ```

### Phase 3: API 및 백엔드 정리 (1일)
1. **API 계약 단순화**
   - `planType` 필드를 'ai-generated' 고정값으로 변경
   - 기존 데이터와의 호환성 보장

2. **데이터 모델 정리**
   - 사용하지 않는 필드 정리
   - AI 기획 최적화된 스키마로 변경

### Phase 4: 품질 보증 (1일)
1. **테스트 실행**
   - 단위 테스트 업데이트 및 실행
   - 통합 테스트 검증
   
2. **품질 게이트 통과**
   - ESLint 규칙 준수 확인
   - TypeScript 컴파일 오류 해결
   - 아키텍처 경계 검증

## 기대 효과

### 1. 코드 품질 개선
- **복잡도 50% 감소**: 모드 선택 로직 제거
- **코드베이스 20% 감소**: 수동 기획 기능 제거
- **타입 안전성 향상**: 중복 타입 제거 및 통합

### 2. 사용자 경험 개선  
- **인지적 부담 제거**: 모드 선택 단계 생략
- **플로우 단순화**: 3단계 → 1단계 직접 진입
- **학습 비용 감소**: 단일 인터페이스 집중

### 3. 개발 생산성 향상
- **유지보수 비용 30% 절감**: 관리 대상 코드 감소  
- **신규 기능 개발 속도 향상**: 명확한 아키텍처 경계
- **팀 협업 효율성 증대**: FSD 원칙 준수

### 4. 아키텍처 개선
- **FSD 원칙 100% 준수**: 레이어별 책임 분리 명확화
- **모듈 응집성 향상**: 관련 기능의 물리적 집중
- **의존성 관리 최적화**: 크로스 레이어 의존성 제거

## 리스크 및 완화 방안

### 리스크 1: 기존 사용자 혼란
**완화 방안**: 
- 기존 기능 접근성 유지 (기획서 목록, 편집 기능)
- 명확한 UI 가이드 및 도움말 제공

### 리스크 2: 데이터 호환성 문제  
**완화 방안**:
- 기존 데이터 마이그레이션 스크립트 작성
- 점진적 타입 변경으로 하위 호환성 보장

### 리스크 3: 테스트 커버리지 감소
**완화 방안**:
- 리팩토링 전 기존 테스트 실행 및 결과 기록
- 새로운 아키텍처에 맞는 테스트 케이스 작성

## 성공 지표

### 기술적 지표
- [ ] ESLint FSD 규칙 위반 0건 달성
- [ ] TypeScript 컴파일 오류 0건 유지  
- [ ] 테스트 커버리지 90% 이상 유지
- [ ] 번들 크기 20% 이상 감소

### 비즈니스 지표  
- [ ] 영상 기획 완성률 30% 향상
- [ ] 사용자 이탈율 50% 감소 (기획 페이지에서)
- [ ] 기획서 생성 시간 60% 단축
- [ ] 개발자 생산성 지표 향상

## 추가 고려사항

### 향후 확장성
리팩토링된 아키텍처는 다음 기능들의 확장을 고려하여 설계되었습니다:

1. **고급 AI 기능**
   - 스토리보드 자동 생성
   - 음성/배경음악 추천
   - 실시간 피드백 시스템

2. **협업 기능 강화**
   - 실시간 공동 편집
   - 댓글 및 리뷰 시스템
   - 버전 관리 고도화

3. **분석 및 최적화**
   - 기획서 성과 분석
   - AI 추천 개선
   - 사용자 행동 분석

### 기술 부채 해결
이번 리팩토링을 통해 해결되는 기술 부채:

1. **아키텍처 부채**: FSD 원칙 위반 완전 해결
2. **코드 중복**: 타입 정의 중복 제거  
3. **테스트 부채**: 명확한 경계로 테스트 용이성 향상
4. **문서 부채**: 단순화된 구조로 문서 유지보수성 개선

---

**결정 승인자**: Arthur (Chief Architect)  
**구현 책임자**: 개발팀 전체  
**검토 주기**: 매 Phase 완료 후  
**최종 리뷰 일정**: 2025-08-28